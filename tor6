from scapy.all import sniff, Raw
from scapy.layers.http import HTTPRequest

def packet_callback(packet):
    if packet.haslayer(HTTPRequest):
        # HTTP Request found
        http_layer = packet.getlayer(HTTPRequest)
        if packet.haslayer(Raw):
            print(f"HTTP {http_layer.Method.decode()} request on {http_layer.Host.decode()}")
            print(f"Data: {packet[Raw].load.decode(errors='ignore')}")

# Sniff HTTP traffic
sniff(iface="eth0", filter="tcp port 80", prn=packet_callback, store=False)
